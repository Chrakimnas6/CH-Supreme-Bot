/**
 * thenjs: v1.4.5
 * https://github.com/teambition/then.js
 */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=b():"function"==typeof define&&define.amd?define([],b):a.Thenjs=b()}("object"==typeof window?window:this,function(){"use strict";function a(a,b){if(b=b||0,b>=a.length)return[];for(var c=a.length,d=Array(c-b);c-->b;)d[c-b]=a[c];return d}function b(b,c){try{c.apply(null,a(arguments,2))}catch(d){b(d)}}function c(){var a=arguments;u(function(){b.apply(null,a)})}function d(a){return null==a?a:"function"==typeof a.toThunk?a.toThunk():"function"==typeof a.then?function(b){a.then(function(a){b(null,a)},b)}:a}function e(a,b){var f,g=this;return a instanceof e?a:g instanceof e?(g._success=g._each=g._eachSeries=g._parallel=g._series=null,g._finally=g._error=g._fail=g._result=g._nextThen=g._chain=null,arguments.length?(f=i(g,b),a=d(a),void(null==a?f():"function"==typeof a?c(f,a,f):f(null,a))):g):new e(a,b)}function f(c){var d=this,e=arguments;d._result!==!1&&(!d._result&&d._chain&&d.debug.apply(d,["\nChain "+d._chain+": "].concat(a(e))),d._result=!1,b(function(a){h(d,a,c)},g,d,e,c))}function g(b,c,d){if(b._finally)return b._finally.apply(null,c);if(null!=d)throw d;var e=b._success||b._each||b._eachSeries||b._parallel||b._series;return e?e.apply(null,a(c,1)):void(b._result=c)}function h(a,b,c){var d=a,f=a._error||a._fail;for(a._nextThen&&null==c&&(f=null,d=a._nextThen);!f&&d;)f=d._fail,d=d._nextThen;return f?f(b):e.onerror?e.onerror(b):void(d._result=[b])}function i(a,b){function c(){return f.apply(a,arguments)}return c._isCont=!0,b&&(w.debug="function"==typeof b?b:q,a._chain=1),c}function j(a,b,c){var d=new e,g=i(d,c);return a(g,b),b?(b._nextThen=d,b._chain&&(d._chain=b._chain+1),b._result&&u(function(){f.apply(b,b._result)}),d):d}function k(b,c){return c._isCont?c:function(){var d=a(arguments);d.unshift(b),c.apply(null,d)}}function l(a,b,c,d){function e(e,f){return c.finished?void 0:null!=e?(c.finished=!0,a(e)):(b[d]=f,--c.i<0&&a(null,b))}return e._isCont=!0,e}function m(a,b,c){var d,e=[],f={};if(!v(b))return a(r(b,"each"));if(f.i=d=b.length-1,0>d)return a(null,e);for(var g=0;d>=g;g++)c(l(a,e,f,g),b[g],g,b)}function n(a,b){var c,d=[],e={};if(!v(b))return a(r(b,"parallel"));if(e.i=c=b.length-1,0>c)return a(null,d);for(var f=0;c>=f;f++)b[f](l(a,d,e,f),f,b)}function o(a,d,e){function f(l,m){return null!=l?a(l):(j[i]=m,++i>g?a(null,j):(h=--k>0?b:(k=s,c),void h(a,e,f,d[i],i,d)))}var g,h,i=0,j=[],k=s;return f._isCont=!0,v(d)?(g=d.length-1,0>g?a(null,j):void e(f,d[0],0,d)):a(r(d,"eachSeries"))}function p(a,d){function e(k,l){return null!=k?a(k):(i[h]=l,++h>f?a(null,i):(g=--j>0?b:(j=s,c),void g(a,d[h],e,h,d)))}var f,g,h=0,i=[],j=s;return e._isCont=!0,v(d)?(f=d.length-1,0>f?a(null,i):void d[0](e,0,d)):a(r(d,"series"))}function q(){console.log.apply(console,arguments)}function r(a,b){return new Error("The argument "+(a&&a.toString())+' in "'+b+'" is not Array!')}var s=100,t=Object.prototype.toString,u="function"==typeof setImmediate?setImmediate:function(a){setTimeout(a,0)},v=Array.isArray||function(a){return"[object Array]"===t.call(a)};e.defer=c,e.each=function(a,b,d){return j(function(d){c(d,m,d,a,b)},null,d)},e.eachSeries=function(a,b,d){return j(function(d){c(d,o,d,a,b)},null,d)},e.parallel=function(a,b){return j(function(b){c(b,n,b,a)},null,b)},e.series=function(a,b){return j(function(b){c(b,p,b,a)},null,b)},e.nextTick=function(b){var c=a(arguments,1);u(function(){b.apply(null,c)})},e.onerror=function(a){throw console.error("Thenjs caught error: ",a),a};var w=e.prototype;return w.fin=w.all=w["finally"]=function(a){return j(function(b,c){c._finally=k(b,a)},this)},w.then=function(a,b){return j(function(c,d){d._success=k(c,a),d._error=b&&k(c,b)},this)},w.fail=w["catch"]=function(b){return j(function(c,d){d._fail=k(c,b),d._success=function(){c.apply(null,[null].concat(a(arguments)))}},this)},w.each=function(a,b){return j(function(c,d){d._each=function(d,e){m(c,a||d,b||e)}},this)},w.eachSeries=function(a,b){return j(function(c,d){d._eachSeries=function(d,e){o(c,a||d,b||e)}},this)},w.parallel=function(a){return j(function(b,c){c._parallel=function(c){n(b,a||c)}},this)},w.series=function(a){return j(function(b,c){c._series=function(c){p(b,a||c)}},this)},w.toThunk=function(){var a=this;return function(b){a._result?(b.apply(null,a._result),a._result=!1):a._result!==!1&&(a._finally=b)}},e.NAME="Thenjs",e.VERSION="1.4.5",e});